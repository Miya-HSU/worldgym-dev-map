name: Auto-generate map and homepage
on:
  push:
    paths:
      - '**.gpx'
      - '**shops.json'
      - '**.py'
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v5
        with:
          python-version: 3.11
      - run: pip install gpxpy folium
      - name: Generate maps
        run: python scripts/generate_map.py
      - name: Generate homepage
        run: python ${{ github.workspace }}/generate_home.py
      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: auto: 更新地圖
